{"metadata": {"version": 1, "disable_limits": false, "instance_type": "ml.m5.4xlarge", "disable_validation": true}, "parameters": [], "nodes": [{"node_id": "790fe075-6c96-46e9-acdd-d00ae43ca1ee", "type": "SOURCE", "operator": "sagemaker.s3_source_0.1", "parameters": {"dataset_definition": {"datasetSourceType": "S3", "name": "data_Table.csv", "description": null, "s3ExecutionContext": {"s3Uri": "s3://552631484635-serg-test/data-Table 1.csv", "s3ContentType": "csv", "s3HasHeader": true, "s3FieldDelimiter": ",", "s3DirIncludesNested": false, "s3AddsFilenameColumn": false, "s3RoleArn": null, "s3CsvEncodingType": "UTF8", "s3SkipLines": 0, "s3MultiLine": false, "s3DataType": "S3Prefix", "s3ManifestPlain": {"s3Uris": null}}, "canvasDatasetMetadata": null}}, "inputs": [], "outputs": [{"name": "default", "sampling": {"sampling_method": "sample_by_count", "sample_size": 50000}}]}, {"node_id": "8b4c3093-20bb-44ff-bd59-e2e27c829ec6", "type": "TRANSFORM", "operator": "sagemaker.spark.infer_and_cast_type_0.1", "parameters": {}, "trained_parameters": {"schema": {"custid": "string", "retained": "long", "created": "datetime", "firstorder": "datetime", "lastorder": "datetime", "esent": "long", "eopenrate": "float", "eclickrate": "float", "avgorder": "float", "ordfreq": "float", "paperless": "long", "refill": "long", "doorstep": "long", "favday": "string", "city": "string"}}, "inputs": [{"name": "default", "node_id": "790fe075-6c96-46e9-acdd-d00ae43ca1ee", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "c1ffc76f-24f0-4e90-a0e9-7d2499e497b7", "type": "TRANSFORM", "operator": "sagemaker.spark.handle_missing_0.1", "parameters": {"operator": "Drop missing", "drop_missing_parameters": {"input_column": ["custid", "retained", "created", "firstorder", "lastorder", "esent", "eopenrate", "eclickrate", "avgorder", "ordfreq", "paperless", "refill", "doorstep", "favday", "city"]}, "impute_parameters": {"column_type": "Numeric", "numeric_parameters": {"strategy": "Approximate Median"}}}, "inputs": [{"name": "df", "node_id": "8b4c3093-20bb-44ff-bd59-e2e27c829ec6", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "b3f82f51-b61b-47a9-9c2c-07e99f12f3bd", "type": "TRANSFORM", "operator": "sagemaker.spark.process_numeric_0.1", "parameters": {"operator": "Scale values", "scale_values_parameters": {"scaler": "Standard scaler", "standard_scaler_parameters": {"input_column": ["eopenrate", "ordfreq", "eclickrate", "avgorder", "esent"], "scale": true}}}, "inputs": [{"name": "df", "node_id": "c1ffc76f-24f0-4e90-a0e9-7d2499e497b7", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "94354db9-502c-4834-a9a8-cafb7b98956d", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "One-hot encode", "one_hot_encode_parameters": {"input_column": ["favday"], "invalid_handling_strategy": "Keep", "drop_last": false, "output_style": "Vector"}, "ordinal_encode_parameters": {"input_column": ["favday"], "invalid_handling_strategy": "Replace with NaN"}}, "inputs": [{"name": "df", "node_id": "b3f82f51-b61b-47a9-9c2c-07e99f12f3bd", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "38327ea3-66e7-4bf2-9fd8-aef26366b863", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "One-hot encode", "one_hot_encode_parameters": {"input_column": ["city"], "invalid_handling_strategy": "Keep", "drop_last": false, "output_style": "Vector"}, "ordinal_encode_parameters": {"input_column": ["city"], "invalid_handling_strategy": "Replace with NaN"}}, "trained_parameters": {"one_hot_encode_parameters": {"_hash": "4623886b68927a4dcb437c2769f9d5234824476a", "string_indexer_model": "P)h>@6aWAK2mp~1!CI~qzfj!(003eE000vJ003=ebYWy+bYU-WVRCdWFfcGMFm;a0PQx$|MfZHhtWzr_hN5oEri%(B5Zh>EPg<*fF}4w*%D-cRgaE<z&OPVO8I;A8U;}{<0wby;i4>7f!dWpA=E5W%G8=!`c}=gx`=H4}1KBuA8C`_U<yzjXrIh_u-*ycw{1b69!B=xHq-a;@-u$YqTrs+aKa@kKl<vl{SJztAO6Ae*v6|0dd@OkzY-N<mQ@w_gzoJYo4k~>7b40H#?feVcW#L2=VQxUvh{fjnZ_c!g-?1isoFdio$n;#utLc`K`nB=@tHbcw`(vG$1H(LDyaP~60|XQR000O8krKgL=wg8H4gdfE3;+NC7ytkOZDn*}WMOn+FD`Ila&#>)FfcGME@N_IOD;-gU|?Wk2-q*O4ggR~0|XQR000O8krKgLZu>Vh&jA1cw*mkFNB{r;WMOn+FK}UUbS*G2FfcGJH8f;mG-5JgEn;D0Gc7b^GdC?_WMXD5HZWynI5B2qHD)z5En_e+FfMa$VQ_GHE^uLTadl;Mjgrx76G0S)XErfeXg~yKnSs3s3kj{pVY1t_Yv_e36{MtEN)bUsW;c_%IJ-%AHcBbEDZT0&2tI%h;5+mQ1Ruw<NvahUyxMdA|37>7o7uy`QI{a{k{pxopTB*oy2OUIMrsH>bSns<$`@3{bvs={_^!SC;sDp5>^&Wp&cR?%K6Zyk?4HGFr7UO#RAMm)A?7+Zxxi2%5cIQ#naceATNA%isU#NaS#(XyNNF?3b9qKAQXB3-xL2iBotR=7sVl8gl@))pNu%{E&_Y8OY{z0QbKAB{8mxtC?A7fZi@}?L-x^{$wsVP{3*5GMw$OTsu^<8rI1eCzSAWICajr0VfXb-Vwjq8WKs%I9@)Itn64>|xlYdaTNhTS+6Yxzg5Z(AAVNNxN;&i48o=-mVR26b03rVl>xmTP`mDl%7k<a47>v-ct>5=jJug|?qrloZY3;bpN=bT*0E4t(VaLZjub^>xd$qJcd=J`x(uMc0K=Kl~gXk?_-Qs{U$2(W8De=|pPe+Bp`&6}$eX?A(n=RtElnk9PF6rwA}+hGt1KOAj_(KzsXLiw@W9t#zQz6wMvw&ddt=9bsH5BG2gzw8fCO9KQH000080Fe^GS}34U!V&-g01yBG08Ib@0AyiwVJ|LlVRCdWFfcGMFfBDSWMVX8GGQ%ZVPrEcG-NY3En;M1W-T@_Wo0-qW@I&HH8d?_FfcGKb8ca9aCt6pVRCVGWpplMa$`#_N@ieSU}AWwxBjBQ@&{}HP)h*<6ay3h000O8krKgLt`xse-2eapVgUdE6951J0000000000q=5hc003=ebYWy+bYU-WVRCdWFfcGMFi=YY0u%!j000080Fe^GTIgbc?+yR}01N;C02lxO00000000000HlEq0RRAPWprU=VRT_HE^uLTbS*G2FfcGKV{&6qO928D0~7!N00;n)62V$-`!_Vt0RRBE0ssI=00000000000001_fl>hg0AyiwVJ~oDa&#>)FfcGMEj2V`Vl-khVJ%`|WHT)^WHUD{Vq{`wEjBP^WjHZrWHn|rG%aH=FfcB2Zeeh6c`k5aa&dKKbWlqH0u%!j000080Fe^GS}34U!V&-g01yBG08Ib@00000000000HlG30{{SIVRT_HE^uLTbS*G2FfcGJH8f;mG-5JgEn;D0Gc7b^GdC?_WMXD5HZWynI5B2qHD)z5En_e+FfMa$VQ_GHE^uLTadl;ME@N_IP)h{{000001ONm8cmV(a1Oxy8000", "one_hot_encoder_model": "P)h>@6aWAK2mp~1!CD1koKVyN003zL000vJ003=ebYWy+bYU-WVRCdWFfcGMFm;YSZvrt4hWGxA%n)%U2k6$S5=ceu)HO0WADo&mIZlV7`|owBT8ZHn50Cvmudm8^C`END(OE+VcR^h;(1#9Q4+vZd^=rg^;^*j6k93sb)k5(YurP$Ix@K#3TVu?+HJfIkZuxhlGNvfzwKjUSgzy!YE6LTd7kH<%uEo>o(F~im*~y9IAsj)>SCuN~%1_Bl$TEg(UGnxvG{*nM9~XLo*n2$0Pw=-QBuXT_r<7lyu<8cz1t%dmK=u4KQ#SvhwZC_FR;G$`?bGz|4Nyx11QY-O00;n)62V$QKI-ib0000C0000O0001OWprU=VRT_HE^uLTbS*G2FfcGKV{&6lE=p!#U|?bhn3Kc`08mQ<1QY-O00;n)62V%ShaJD90RR9^0ssI=0001FVRT_HaA9(EEif=JFfc7JW;bFuVPrKeFf=wfEi^S^G%aE|WHv2iWo0liI5{(6W@9-mV=yo<E^}^SaBz7paA9(Bb!BvAQqgMLFcekPG|R*GP^g3qeh7kw7E+<u&FY3eY;R?h64t!6r6`WvnaOr4DI00Y59|x}SNn&3M4w98U7VJcVUTq0JxBK(;nBy>eS!!lUGn?a)8j@+Fu)dRA++@YBZM~KgB7Dq*n%w_u;%JiZv+PvKuFtUOly34^486i{d(=vFS<|!qXA~`QswncWf$l9opvyzb$Sf+L6bF2?mUnP-a+h*HoDNIM-&HP5O&*OC)h!)AbEYkO7u)7m|{Aj<8J%7HdU__?f!$nBjkc9(D>0H+w_tM1S;HZ)A2U6dyG}~MyQzr+hUbKeACwDRmnDEaUdjOd;c-qtr2jzoog>_^<5O&tEuve{cPNGznE!0<j&i9>Uoc6xi(YBhZpy}RK?%ct5CqG6)#F<ty(~N9duk*^AbebLOrcYukzBJ&5hy1Oc|$_JzfG*69ZHjtb6>~6I{GpUM&&(w068-*v>j)r!V@Eh&#KJd2Xg1Df==zOyY@*lIcM*$>L}rb(E^ZOzI?wbSzW(ULEZPVF+*g&_HMeKhhsiO9KQH000080Fe^GTB(WC)Di#y01yBG08Ib@0AyiwVJ|LlVRCdWFfcGMFfA}<H)1$pWHl`?G&VUcG&N#0En+!jHZ5djWiT-~IWu8qV>vBjFfcGKb8ca9aCt6pVRCVGWpplMa$`#_N@ieSU}8`b31X3+(r*I*P)h*<6ay3h000O8krKgL1!9~~)BpegX#oHL6951J0000000000q=5hc003=ebYWy+bYU-WVRCdWFfcGMFi=YY0u%!j000080Fe^GT0uVQ?G69{01N;C02lxO00000000000HlEh0RRAPWprU=VRT_HE^uLTbS*G2FfcGKV{&6qO928D0~7!N00;n)62V%ShaJD90RR9^0ssI=00000000000001_fk^=X0AyiwVJ~oDa&#>)FfcGMEih&`VmM)BH7zhSHaRUcHDWX^VmV|sEo5b7FflkeGht?9IW1!_FfcB2Zeeh6c`k5aa&dKKbWlqH0u%!j000080Fe^GTB(WC)Di#y01yBG08Ib@00000000000HlFa0{{SIVRT_HE^uLTbS*G2FfcGJFlIMmIALTpEig1TIW06bVl*vcIb=31WMySAF*rFhVP<1FEn_e+FfMa$VQ_GHE^uLTadl;ME@N_IP)h{{000001ONm8cmV(a&;tMf000"}}, "inputs": [{"name": "df", "node_id": "94354db9-502c-4834-a9a8-cafb7b98956d", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "8fd4542c-5d8a-41ff-9f40-3bbac04d1af0", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "favday", "original_data_type": "Object", "data_type": "string"}, "inputs": [{"name": "df", "node_id": "38327ea3-66e7-4bf2-9fd8-aef26366b863", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "fe8c29cd-e942-4604-b5a6-33f3a35108b9", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "city", "original_data_type": "Object", "data_type": "string"}, "inputs": [{"name": "df", "node_id": "8fd4542c-5d8a-41ff-9f40-3bbac04d1af0", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "9f556da6-2ff1-4c7c-9454-cc678b0aeaae", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (PySpark)", "pyspark_parameters": {"code": "# Table is available as variable `df`\nfrom pyspark.sql.functions import date_format\n\ndf = df.withColumn(\"created_iso\", date_format(\"created\", \"yyyy-MM-dd'T'HH:mm:ss'Z'\"))"}, "name": "Create Event Time Feature"}, "inputs": [{"name": "df", "node_id": "fe8c29cd-e942-4604-b5a6-33f3a35108b9", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "5f589d78-9015-482f-9a27-8cf00be8ea95", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (PySpark)", "pyspark_parameters": {"code": "# Table is available as variable `df`\nfrom pyspark.sql.functions import datediff, current_date\n\ndf = df.withColumn(\"account_age_days\", datediff(current_date(), df[\"created\"]))\n\ndf = df.drop(\"created\", \"firstorder\", \"lastorder\")"}, "name": "Create Time Features"}, "inputs": [{"name": "df", "node_id": "9f556da6-2ff1-4c7c-9454-cc678b0aeaae", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "e56a13a1-cef1-4a38-803a-da35f6a7ee9e", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "6-2-2025_6:55:29_PM", "insights_report_parameters": {}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "5f589d78-9015-482f-9a27-8cf00be8ea95", "output_name": "default"}], "outputs": [{"name": "default"}]}]}